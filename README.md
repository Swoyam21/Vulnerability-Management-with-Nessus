# Vulnerability-Management-with-Nessus

<h2>Description</h2>
In this project, I have set up an Nessus Vulnerability Management Scanner. The goal was to develop a vulnerable Windows 10 Virtual Machine using VmWare with outdated software and disabled security controls. I performed both unauthenticated and credentialed vulnerability scans using Nessus and then proceeded to remediate the identified vulnerabilities.
<br />

<h2>Tools, Technologies and Evnironments used</h2>

- <b>Nessus</b>
- <b>VmWare</b>
- <b>Windows 10 (Vulnerable Device)</b>

<h2>Walkthrough:</h2>
<h4>Things we need to download for the project success and we can use the link to download:</h4>

<li>Nessus : <a href="https://www.tenable.com/products/nessus/nessus-essentials">Download Nessus</a></li>
<li>VmWare : <a href="https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html">Download VmWare</a></li>
<li>Windows 10 : <a href="https://www.microsoft.com/en-us/software-download/windows10">Download Windows 10 ISO file</a></li>

<h4>Setting up Virtual Machine</h4>

Start the VmWare and click on Player, We can click on Create a New Virtual Machine, clicking that option.

<img src="https://imgur.com/uDq0xJm.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

Make Sure to Customize the Hardware Setting by choosing the Network Connection to Bridged for better result.

<img src="https://imgur.com/zQd8ARu.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

It will take a while to setup and I choose the Windows 10 for this project and after that it will show something like the below photo:

<img src="https://imgur.com/2rhAmIS.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

Making Sure to turn off all the settings for the device to make it more vulnerable.

<img src="https://imgur.com/PMgsuxn.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

Now Working with the Nessus, When we setup the Nessus we get the link, In my case it was <a href="http://localhost:8834/WelcomeToNessus-Install/welcome">link</a>. I created my user name and password to access the Nessus. After you Sign in you will see something like this below: 

<img src="https://imgur.com/nUHacsc.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

**In Virtual Machine:** Now to turn off the Firewalls in our Virtual Machine in looking for wf.msc in the search bar of the virtual machine.

<img src="https://imgur.com/u9ohPYW.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

**In Virtual Machine:** Now clicking on Windows Defender Firewall Properties and turning off firewalls for Domain Profile, Private Profile, Public Profile to make the virtual machine more vulnerable as shown below:

<img src="https://imgur.com/wi7qJy3.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>
<img src="https://imgur.com/5yKvugT.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

Now we go to the Command prompt in the virtual machine and type "ipconfig" to get the ip address of the vitual machine which we will use to scan on the Nessus. The IPv4 Address is the Ip Address of the VM.

<img src="https://imgur.com/0F5GXVY.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

Initially we are just doing the basic Network Scan. So, we choose that in the Nessus and Use the Ip Address of the Virtual Machine in the Scan as shown below:

<img src="https://imgur.com/erbr8lE.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

When we save it, It will show the saved My Scans and we can start it by pressing the Launch button on th right side of the file. In my case, we will start it and see the vulnerabilities for now.

<img src="https://imgur.com/LXbHAdn.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

After couple fo minutes, it Seems like it only found one medium level Vulnerabilities and a lot of  information: 

<img src="https://imgur.com/ATXjIqS.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

**In Virtual Machine**: We will enable Remote Registry on the Virtual Machine which will allow the scanner to connect to this computer's registry to see the insecure configuration. You can search for services in the search bar of the Virtual machine and look for Remote Registry and Enable it.

<img src="https://imgur.com/Tydfm5k.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

**In Virtual Machine:** Now we set the User Account Control Settings to Never Notify so that it will be more vulnerable and can have security risk or accidental changes and we can scan those vulnerabilities in the system and detect it in our Nessus.

<img src="https://imgur.com/zSbQJ9r.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

Now we will add one DWord in the Registry Editor by going to the file Local Machine > Software > Microsoft> Windows > CurrentVersions >  Policies > System. Inside here we will create a DWord named:  "**LocalAccountTokenFilterPolicy**" and we will set the value to 1. After doing all this, We will restart the Virtual Machine to start will all the changes we made and all the new vulnerabilities.

<img src="https://imgur.com/Puw50Mz.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>
<h3>Changing the config on Nessus on our own Computer</h3>
After the Restart of the Virtual Machine, Now we will make changes in our Scan in the Nessus. Check the box of the scan and click on more and then on config. Then we add a set of credientials and we will add a windows Credentials. Use the Username of the Virtual Machine and same password and then save

<img src="https://imgur.com/vowYyBF.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>
<img src="https://imgur.com/ZSkZela.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

After Making all the Changes we save and Re-Run the scan.

<img src="https://imgur.com/NdjQ7bG.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

<h2>After Waiting for Half an hour</h2>

We can see we found more vulnerabilities this time. We can see couple of critical, high, medium vulnerabilities as well.We can look for Remediations and works on them. We found around 43 Vulnerabilities, 1 Remediations as shown in below: 

<img src="https://imgur.com/1Xzmr9C.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>
<img src="https://imgur.com/K44EVel.png" height="80%" width="80%" alt="Custom Log"/><br />
</p>

**In Virtual Machine:** Now we will download a very old version of the firefox in Virtual Machine and Re-Run the Scan in our actual computer in Nessus and see the see the changes we get in the scans. We used this <a href="https://ftp.mozilla.org/pub/firefox/releases/3.6.12/win32/en-US/">link</a>  to download the old version of the firefox.

We will see the screen something like below and download it.
<img src="https://imgur.com/vhqmD7G.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>
We Install the old firefox in the Virtual Machine like below: 
<img src="https://imgur.com/I1N9jL0.png" height="80%" width="80%" alt="Custom Log"/><br />

After all these new changes in our Virtual Machine, We will Re-Run the Scan in Nessus without making any changes on credentials or any setting and wait for it to give us the reports.

<img src="https://imgur.com/qkHNpyM.png" height="80%" width="80%" alt="Custom Log"/><br />
</p>

From History, We can see we did scaned our Virtual Machine 3 times:
<img src="https://imgur.com/qkHNpyM.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

<h2>Let's Compare our all 3 Scans</h2>

<h3>First Scan</h3>
We just scanned our Virtual Machine will the fewest Vulnerabilities and got this result.

<img src="https://imgur.com/ATXjIqS.png" height="80%" width="80%" alt="Custom Log"/><br /><br />
</p>

<h3>Second Scan</h3>
We made couple of changes on the system and made it more vulnerable while making changes in credentials in the Nessus it self and this was the result of the Scan.

<img src="https://imgur.com/K44EVel.png" height="80%" width="80%" alt="Custom Log"/><br />
</p>

<h3>Final Scan</h3>
We download the very old version of Firefox in VM which made our VM more vulnerable and this was the final results for the final scan.

<img src="https://imgur.com/ZpwcGnp.png" height="80%" width="80%" alt="Custom Log"/><br />
</p>

After all the changes, Our system look really Vulnerable. We can see on the Remediations tab on how we can remediate the Vulnerabilities.

<img src="https://imgur.com/HJtRyp2.png" height="80%" width="80%" alt="Custom Log"/><br />
</p>

<h2>Remediations</h2>
Now Let's try remediating the vulnerabilities by applying the suggestion on the Remediations tab. The first one is related to Firefox, We can either delete the firefox or update it to the latest version. The Second one is to do the Windows updates. Let's do it: 

1. Uninstall The Firefox

<img src="https://imgur.com/34fYPpr.png" height="80%" width="80%" alt="Custom Log"/><br />
</p>

2. Running the Windows Update

<img src="https://imgur.com/L1PqhhZ.png" height="80%" width="80%" alt="Custom Log"/><br />
</p>

Finally We restart the Vm and Re-Scan it and majority of the Vulnerabilities must be remediated.

<img src="https://imgur.com/oP7oxco.png" height="80%" width="80%" alt="Custom Log"/><br />
</p>

Here is the final Scan:
<br /><img src="https://imgur.com/JhU2s9s.png" height="80%" width="80%" alt="Custom Log"/><br />
</p>

The Result of the final scan and it clearly shows that majority of the Vulberabilities were remidated:
<img src="https://imgur.com/kQl8yMg.png" height="80%" width="80%" alt="Custom Log"/><br />
</p>
